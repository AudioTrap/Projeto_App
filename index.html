<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>AudioTrap</title>
    <link rel="stylesheet" href="style.css" />

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/speech-commands@0.4.0/dist/speech-commands.min.js"></script>
    <script defer src="script.js"></script>
</head>

<body>
    <header>
        <h1>AudioTrap</h1>
        <nav>
            <a href="#inicio">In√≠cio</a>
            <a href="#como-funciona">Como funciona</a>
            <a href="#detector">Detector</a>
            <a href="#equipe">Equipe</a>
            <a href="#contato">Contato</a>
        </nav>
    </header>

    <section id="inicio">
        <h2>In√≠cio</h2>
        <p>Bem-vindo ao AudioTrap! Um app inclusivo que detecta sons importantes como latidos, buzinas e sirenes, enviando alertas visuais para pessoas com defici√™ncia auditiva.</p>
    </section>

    <section id="como-funciona">
        <h2>Como Funciona</h2>
        <ol>
            <li>O microfone capta os sons do ambiente.</li>
            <li>O modelo inteligente reconhece sons como latidos, buzinas e alarmes.</li>
            <li>Um alerta visual √© exibido na tela com imagem e descri√ß√£o.</li>
        </ol>
    </section>

    <section id="detector">
        <h2>Detector de Sons</h2>
        <button onclick="init()">Iniciar Detector</button>
        <p id="audio-alert">Aguardando som...</p>
        <img id="alert-image" src="" alt="Som detectado" style="display:none; width: 150px;">
    </section>

    <section id="equipe">
        <h2>Equipe</h2>
        <p>Somos o time NorthGirls, estudantes do IFRO comprometidas em promover a inclus√£o atrav√©s da tecnologia.</p>
    </section>

    <section id="contato">
        <h2>Contato</h2>
        <p>Email: <a href="mailto:audiotrapp4g.com">audiotrapp4g.com</a></p>
        <p>Instagram: <a href="https://instagram.com/audiotrap.ro" target="_blank">@audiotrap.ro</a></p>
        <p>TikTok: <a href="https://tiktok.com/@audiotrap.ro" target="_blank">@audiotrap.ro</a></p>
    </section>

    <footer>
        &copy; 2025 AudioTrap - NorthGirls
    </footer>

    <script type="module">
        import * as tmAudio from "https://cdn.jsdelivr.net/npm/@teachablemachine/audio@0.8.4/dist/teachablemachine-audio.min.js";

        const URL = "https://teachablemachine.withgoogle.com/models/I9hL16mkw/";
        let model, audio, labelContainer;

        async function init() {
            model = await tmAudio.load(URL + "model.json", URL + "metadata.json");
            audio = new tmAudio.AudioModel(model);
            await audio.listen(result => {
                const label = result.label;
                const confidence = (result.confidencesByLabel[label] * 100).toFixed(2);
                const output = document.getElementById("audio-alert");
                const alertImage = document.getElementById("alert-image");

                if (confidence > 0.75) {
                    output.innerText = `üîä Som detectado: ${label} (${(confidence * 100).toFixed(2)}%)`;

                    if (label === "Buzina") {
                        alertImage.src = "imagens/buzina.png";
                    } else if (label === "Cachorro-latindo") {
                        alertImage.src = "imagens/cachorro-latindo.png";
                    } else if (label === "Sirene") {
                        alertImage.src = "imagens/sirene.png";
                    } else if (label === "Palmas") {
                        alertImage.src = "imagens/palmas.png";
                    } else if (label === "Estalos") {
                        alertImage.src = "imagens/estalos.png";
                    } else {
                        alertImage.src = "imagens/som-desconhecido.png"; 
                    }

                    alertImage.style.display = "block";
                    } else {
                    output.innerText = "Aguardando som...";
                    alertImage.style.display = "none";
                    }
            }, {
                probabilityThreshold: 0.75
            });
        }

        window.init = init;
    </script>

</body>
</html>
